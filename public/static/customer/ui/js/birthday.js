(function($){$.extend({ms_DatePicker:function(options){var defaults={YearSelector:"#sel_year",MonthSelector:"#sel_month",DaySelector:"#sel_day",FirstText:"--",FirstValue:0};var opts=$.extend({},defaults,options);var $YearSelector=$(opts.YearSelector);var $MonthSelector=$(opts.MonthSelector);var $DaySelector=$(opts.DaySelector);var FirstText=opts.FirstText;var FirstValue=opts.FirstValue;var yearNow=new Date().getFullYear();var monthNow=new Date().getMonth()+1;var dayNow=new Date().getDate();var str='<option value="'+FirstValue+'">'+FirstText+"</option>";$YearSelector.html(str);$MonthSelector.html(str);$DaySelector.html(str);function buildYear(){var yearSel=parseInt($YearSelector.attr("rel"));for(var i=yearNow;i>=1900;i--){var sed=yearSel===i?"selected":"";var yearStr='<option value="'+i+'" '+sed+">"+i+"</option>";$YearSelector.append(yearStr)}}function buildMonth(){$MonthSelector.html(str);var m=parseInt($YearSelector.val())===yearNow?monthNow:12;var monthSel=parseInt($MonthSelector.attr("rel"));for(var i=1;i<=m;i++){var sed=monthSel===i?"selected":"";var monthStr='<option value="'+i+'" '+sed+">"+i+"</option>";$MonthSelector.append(monthStr)}}function BuildDay(){var dayCount=0;var yearSelect=parseInt($YearSelector.val());var monthSelect=parseInt($MonthSelector.val());if(yearSelect===0||monthSelect===0){$DaySelector.html(str)}else{if(yearSelect===yearNow&&monthSelect===monthNow){$DaySelector.html(str);dayCount=dayNow}else{$DaySelector.html(str);var year=parseInt($YearSelector.val());var month=parseInt($MonthSelector.val());dayCount=0;switch(month){case 1:case 3:case 5:case 7:case 8:case 10:case 12:dayCount=31;break;case 4:case 6:case 9:case 11:dayCount=30;break;case 2:dayCount=28;if((year%4==0)&&(year%100!=0)||(year%400==0)){dayCount=29}break;default:break}}}var daySel=parseInt($DaySelector.attr("rel"));for(var i=1;i<=dayCount;i++){var sed=daySel===i?"selected":"";var dayStr='<option value="'+i+'" '+sed+">"+i+"</option>";$DaySelector.append(dayStr)}}buildYear();buildMonth();$MonthSelector.add($YearSelector).change(function(){$YearSelector.attr("rel","--");$MonthSelector.attr("rel","--");$DaySelector.attr("rel","--")});$MonthSelector.change(function(){BuildDay()});$YearSelector.change(function(){buildMonth();BuildDay()});if($DaySelector.attr("rel")!=""){BuildDay()}}})})(jQuery);